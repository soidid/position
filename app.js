(function(){var t=angular.module("ivodControllers",["ui.router"]);t.controller("positionCtrl",["$state","$location","$scope","lyData","$http",function(t,o,e,n){e.setMargin=function(){console.log("SET MARGIN");var t=$("#nav_segment").css("height");t&&(t=parseInt(t.split("px")[0])+10+"px",$("#main_content").css("margin-top",t))},$(window).resize(function(){e.setMargin()}),e.legislators=[],0==e.legislators.length&&n.getData().then(function(t){e.legislators=t;for(var o=0;o<e.legislators.length;o++)e.legislators[o].id=o}),e.categories=["for","pending","against"],e.parties=["position","position.kmt","position.dpp","position.pfp","position.tsu","position.npsu","position.no-party"],e.$state=t,e.legClick=function(t){e.data={},e.data=e.legislators[t],e.currentActiveLeg=t,e.setMargin()},e.isActiveLeg=function(t){return e.currentActiveLeg===t},e.goback=function(){var t=$("html, body");t.animate({scrollTop:0},"500","swing")},e.isActiveParty=function(t){return e.currentActiveParty===t},e.setActiveParty=function(t){e.currentActiveParty=t},$(window).scroll(function(){var t=100;$(window).scrollTop()+$(window).height()>$(document).height()-t?($("#bottom_search").removeClass("nav_fixed"),$("#bottom_join").removeClass("nav_fixed"),$("#bottom_join").removeClass("join_button_area_top")):($("#bottom_search").addClass("nav_fixed"),$("#bottom_join").addClass("nav_fixed"),$("#bottom_join").addClass("join_button_area_top"))}),e.goLegi=function(t){o.path("legi/"+t)}}]),t.controller("legCtrl",["$state","$scope","lyData",function(t,o,e){o.legId=t.params.legId?+t.params.legId:1,o.legislators=[],0==o.legislators.length&&e.getData().then(function(t){o.legislators=t;for(var e=0;e<o.legislators.length;e++)o.legislators[e].id=e;o.data=o.legislators[o.legId]})}]),t.controller("listCtrl",["$scope","lyData","$http",function(t,o){t.signers=[],0==t.signers.length&&o.getData().then(function(o){t.signers=o})}]),t.controller("footCtrl",["$location","$scope",function(t,o){o.go=function(o){t.path(o)},o.goExternal=function(t){window.open(t)}}]),t.controller("aboutCtrl",["$location","$scope","lyData","$http","$state",function(t,o,e){if("/sign"!==t.path()&&$(document.body).animate({scrollTop:0},500,"swing"),o.groups=[],0==o.groups.length&&e.getGroup().then(function(t){console.log("group"),o.groups=t}),o.goback=function(){var t=$("html, body");t.animate({scrollTop:0},500,"swing")},o.showBox=function(){$("#alert_box").show()},o.hideBox=function(){$("#alert_box").hide()},$(".ui.checkbox").checkbox(),o.show=$("input[name=show]:checked").length,o.user={},o.submit=function(){console.log(o.user.name),console.log(o.user.email),console.log(o.show)},o.go=function(o){t.path(o)},"/sign"===t.path()){var n=$("html, body"),i=$("#petition_component").offset().top-50;n.animate({scrollTop:i},500,"swing")}}]),t.controller("navCtrl",["$scope","$state",function(t,o){t.$state=o;{var e=document.querySelector.bind(document),n=e(".navdrawer-container"),i=document.body,a=e(".app-bar");e(".menu"),e("main")}t.closeMenu=function(){i.classList.remove("open"),a.classList.remove("open"),n.classList.remove("open")},t.toggleMenu=function(){console.log("toggle"),i.classList.toggle("open"),a.classList.toggle("open"),n.classList.toggle("open")},t.goPetition=function(){t.closeMenu();var o=$("html, body"),e=$("#petition_component").offset().top-50;o.animate({scrollTop:e},1e3,"swing")}}]),t.filter("byParty",["$state","$filter",function(t,o){return function(e){return"position"==t.current.name?e:o("filter")(e,{party:t.current.data.text})}}])}).call(this),function(){var t=angular.module("lyServices",[]);t.factory("lyData",["$http","$q",function(t,o){function e(t,o){for(var e in t)if(t[e].name==o)return e;return-1}function n(t,o){return s=[],$.each(t,function(t,n){var i={},a=t;n.name!=o[t].name&&(a=e(o,n.name)),i.name=n.name,i.party=n.party,i.party_eng=n.partyEng,i.caucus=n.caucus,i.constituency=l(n.constituency),i.contact=n.contact,i.avatar=n.avatar,i.constituency_detail=n.constituency_detail,i.position=o[a].position,i.reason=o[a].reason,s.push(i)}),s}var i="/data/ly-info.json",a="/data/ly-position.json",r="/data/group.json",s=[];iso3166tw={CHA:"彰化縣",CYI:"嘉義市",CYQ:"嘉義縣",HSQ:"新竹縣",HSZ:"新竹市",HUA:"花蓮縣",ILA:"宜蘭縣",KEE:"基隆市",KHH:"高雄市",KHQ:"高雄市",MIA:"苗栗縣",NAN:"南投縣",PEN:"澎湖縣",PIF:"屏東縣",TAO:"桃園縣",TNN:"台南市",TNQ:"台南市",TPE:"台北市",TPQ:"新北市",TTT:"台東縣",TXG:"台中市",TXQ:"台中市",YUN:"雲林縣",JME:"金門縣",LJF:"連江縣"};var l=function(t){switch(t[0]){case"proportional":return"全國不分區";case"aborigine":return"山地原住民";case"foreign":return"僑居國外國民";default:return result=t[0]in iso3166tw?0==t[1]?iso3166tw[t[0]]:iso3166tw[t[0]]+"第"+t[1]+"選區":t[0]+"<br>"+t[1]}},c=function(){var e=o.defer();return t({method:"GET",url:i}).success(function(o){t({method:"GET",url:a}).success(function(t){e.resolve(n(o,t))})}),e.promise},u=function(){var e=o.defer();return t({method:"GET",url:r}).success(function(t){console.log("success"),e.resolve(t)}),e.promise};return{getData:c,getGroup:u}}])}.call(this);var ivodApp=angular.module("ivodApp",["ui.router","lyServices","ivodControllers"]);ivodApp.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,o,e){e.html5Mode(!0),o.otherwise("/"),t.state("position",{url:"/position",data:{text:"全部"},templateUrl:"/partials/position.html",controller:"positionCtrl"}).state("position.kmt",{url:"kmt",data:{text:"中國國民黨"},templateUrl:"/partials/position.html",controller:"positionCtrl"}).state("position.dpp",{url:"dpp",data:{text:"民主進步黨"},templateUrl:"/partials/position.html",controller:"positionCtrl"}).state("position.pfp",{url:"pfp",data:{text:"親民黨"},templateUrl:"/partials/position.html",controller:"positionCtrl"}).state("position.tsu",{url:"tsu",data:{text:"台灣團結聯盟"},templateUrl:"/partials/position.html",controller:"positionCtrl"}).state("position.npsu",{url:"npsu",data:{text:"無黨團結聯盟"},templateUrl:"/partials/position.html",controller:"positionCtrl"}).state("position.no-party",{url:"no-party",data:{text:"無黨籍"},templateUrl:"/partials/position.html",controller:"positionCtrl"}).state("about",{url:"/",templateUrl:"/partials/about.html",controller:"aboutCtrl"}).state("sign",{url:"/sign",templateUrl:"/partials/about.html",controller:"aboutCtrl"}).state("data",{url:"/data",templateUrl:"/partials/data.html"}).state("contact",{url:"/contact",templateUrl:"/partials/contact.html",controller:"aboutCtrl"}).state("legi",{url:"/legi",templateUrl:"/partials/legi.html",controller:"legCtrl"}).state("legi.legId",{url:"/:legId",templateUrl:"/partials/legi.html",controller:"legCtrl"})}]),$(function(){var t=window.jQuery;t.tablesort=function(o,e){var n=this;this.$table=o,this.$thead=this.$table.find("thead"),this.settings=t.extend({},t.tablesort.defaults,e),this.$table.find("th").bind("click.tablesort",function(){n.sort(t(this))}),this.index=null,this.$th=null,this.direction=null},t.tablesort.prototype={sort:function(o,e){var n=new Date,i=this,a=this.$table,r=this.$thead.length>0?a.find("tbody tr"):a.find("tr").has("td"),s=a.find("tr td:nth-of-type("+(o.index()+1)+")"),l=o.data().sortBy,c=[],u=s.map(function(e,n){return l?"function"==typeof l?l(t(o),t(n),i):l:null!=t(this).data().sortValue?t(this).data().sortValue:t(this).text()});if(0!==u.length){i.$table.find("th").removeClass(i.settings.asc+" "+i.settings.desc),this.direction="asc"!==e&&"desc"!==e?"asc"===this.direction?"desc":"asc":e,e="asc"==this.direction?1:-1,i.$table.trigger("tablesort:start",[i]),i.log("Sorting by "+this.index+" "+this.direction);for(var p=0,d=u.length;d>p;p++)c.push({index:p,cell:s[p],row:r[p],value:u[p]});c.sort(function(t,o){return t.value>o.value?1*e:t.value<o.value?-1*e:0}),t.each(c,function(t,o){a.append(o.row)}),o.addClass(i.settings[i.direction]),i.log("Sort finished in "+((new Date).getTime()-n.getTime())+"ms"),i.$table.trigger("tablesort:complete",[i])}},log:function(o){(t.tablesort.DEBUG||this.settings.debug)&&console&&console.log&&console.log("[tablesort] "+o)},destroy:function(){return this.$table.find("th").unbind("click.tablesort"),this.$table.data("tablesort",null),null}},t.tablesort.DEBUG=!1,t.tablesort.defaults={debug:t.tablesort.DEBUG,asc:"sorted ascending",desc:"sorted descending"},t.fn.tablesort=function(o){var e,n;return this.each(function(){e=t(this),n=e.data("tablesort"),n&&n.destroy(),e.data("tablesort",new t.tablesort(e,o))})}});